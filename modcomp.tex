\documentclass[12pt,]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
    \usepackage{xltxtra,xunicode}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}
  \newcommand{\euro}{€}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\ifxetex
  \usepackage[setpagesize=false, % page size defined by xetex
              unicode=false, % unicode breaks when used with xetex
              xetex]{hyperref}
\else
  \usepackage[unicode=true]{hyperref}
\fi
\hypersetup{breaklinks=true,
            bookmarks=true,
            pdfauthor={Guilherme Garcia1,2, Felipe Bandoni de Oliveira1 \& Gabriel Marroig1},
            pdftitle={Type I and II Error Rates in Modularity Hypothesis Testing},
            colorlinks=true,
            citecolor=blue,
            urlcolor=blue,
            linkcolor=magenta,
            pdfborder={0 0 0}}
\urlstyle{same}  % don't use monospace font for urls
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\setcounter{secnumdepth}{0}

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\newcommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}
  \title{Type I and II Error Rates in Modularity Hypothesis Testing}
  \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
  \author{Guilherme Garcia\textsuperscript{1,2}, Felipe Bandoni de
Oliveira\textsuperscript{1} \& Gabriel Marroig\textsuperscript{1}}
  \preauthor{\centering\large\emph}
  \postauthor{\par}
  \predate{\centering\large\emph}
  \postdate{\par}
  \date{07 July 2015}

%--- USEPACKAGES ---
\usepackage[utf8]{inputenc}
\usepackage{natbib}
\usepackage[brazilian,english]{babel}
\usepackage{hyperref}
\usepackage{subfigure, epsfig}
\usepackage{ae}
\usepackage{aecompl}
\usepackage{booktabs}
\usepackage[T1]{fontenc}
\usepackage{graphicx,wrapfig} % para incluir figuras
\usepackage{amsfonts, amssymb,amsthm, amsmath, amscd} % pacote AMS
\usepackage{color, bbm, multicol}
\usepackage{verbatim, listings, booktabs}
\usepackage{fancyhdr} % FANCYHEADER
\usepackage{setspace}
\usepackage{times} % bookman,palatino,courier,times FONTES
\usepackage{lineno}
\usepackage{url}
\usepackage{rotating}
\usepackage{longtable}
% \usepackage{rotfloat}
% \usepackage{appendix}
\usepackage{mathptmx}
% \usepackage{cmbright}
% \usepackage[adobe-utopia]{mathdesign}
\usepackage[flushleft]{threeparttable}
\usepackage{multirow}
% \usepackage{float}
\usepackage {tocvsec2} % controlar profundidade de table of contents
\setcounter {secnumdepth}{0}
\usepackage {caption}
\usepackage {tabularx}
\usepackage {floatrow}
\floatsetup[table]{capposition=top}

\usepackage{mathpazo} % fonte palatino

\newcommand{\barra}{\backslash}
\newcommand{\To}{\longrightarrow}
\newcommand{\abs}[1]{\left\vert#1\right\vert}
\newcommand{\set}[1]{\left\{#1\right\}}
\newcommand{\seq}[1]{\left<#1\right>}
\newcommand{\norma}[1]{\left\Vert#1\right\Vert}
\newcommand{\hr}{\par\noindent\hrulefill\par}

\usepackage {xr}
\externaldocument{sup_modcomp}

\selectlanguage{english}

\hypersetup{colorlinks=false}


\begin{document}

\maketitle


\linenumbers
\modulolinenumbers[2]

\onehalfspacing

\textsuperscript{1}Laboratório de Evolução de Mamíferos, Departamento de
Genética e Biologia Evolutiva, Instituto de Biociências, Universidade de
São Paulo, CP 11.461, CEP 05422-970, São Paulo, Brasil

\textsuperscript{2}\href{mailto:wgar@usp.br}{wgar@usp.br}

running title: Error in Modularity Hypothesis Testing

key words:

\section{Introduction}\label{introduction}

Modularity is a characteristic property of biological systems that
exhibit an uneven distribution of interactions between their composing
elements; i.e., in a given system, certain subsets of elements,
denominated modules, interact more among themselves than with other such
subsets (Newman, 2006; Mitteroecker \& Bookstein, 2007; Wagner \emph{et
al.}, 2007; Klingenberg, 2008). Regarding morphological systems,
modularity is conceived as the result of genetic and functional
interactions, as expressed throughout development (Cheverud, 1996;
Wagner, 1996; Polly, 2008).

In the present work, we compare the methods described both by Cheverud
et al. (1989) and Klingenberg (2009) to test \emph{a priori} defined
modularity patterns, using anthropoid primates as a model organism. In
order to also compare the performance of these methods with respect to
different representations of form, sample units are represented both as
interlandmark distances and shape variables. Furthermore, we also used
an approach based on the construction of theoretical correlation
matrices; in this context, these matrices are used in order to estimate
Type I and Type II error rates for both methods. Since these methods
were designed under different frameworks, the present work also puts
some effort into unifying both methods into the same conceptual and
statistical framework, in order to produce meaningful comparisons.

\section{Methods}\label{methods}

\subsection{Sample}\label{sample}

The database used here (\autoref{tab:modcomp_otu}) consists of 21
species, distributed across all taxonomic denominations of Anthropoidea
above the genus level. These OTUs were selected from a broader database
(Marroig \& Cheverud, 2001; Oliveira \emph{et al.}, 2009) in order to
reduce the effects of low sample sizes over estimates of modularity
patterns. Individuals in our sample are represented by 36 registered
landmarks, using either a Polhemus 3Draw or a Microscribe 3DS for
Platyrrhini and Catarrhini, respectively. Twenty-two unique landmarks
represent each individual (\autoref{fig:landmarks}, \autoref{tab:lms}),
since 14 of the 36 registered landmarks are bilaterally symmetrical. For
more details on landmark registration, see Marroig \& Cheverud (2001)
and Oliveira et al. (2009).

\input{Tables/modcomp_otu}

For each OTU, we estimated phenotypic covariance and correlation
matrices for three different types of variables: tangent space
residuals, estimated from a Procrustes superimposition for the entire
sample, using the set of landmarks described on both \autoref{tab:lms}
and \autoref{fig:landmarks} (henceforth refered to as Procrustes
residuals); interlandmark distances, as described in \autoref{tab:dist};
and local shape variables (Márquez \emph{et al.}, 2012), which are
measurements of infinitesimal log volume transformations between each
sample unit and a reference (mean) shape. These transformations were
calculated at 38 points, corresponding to the locations of the mipoints
between pairs of landmarks used to calculate interlandmark distances, in
order to produce a dataset that represents shape (i.e., form without
isometric variation; Bookstein, 1991; Zelditch \emph{et al.}, 2004)
while retaining the same overall properties of the interlandmark
distance dataset, such as dimensionality, for instance. Furthermore, the
same hypotheses of trait association can be used on both types of
variables since the position of local shape variables through the skull
mirrors the position of interlandmark distances, although they are
conceptually different types of measurements.

Here we consider only covariance or correlation structure for the
symmetrical component of variation; therefore, prior to any analysis, we
need to control for variation in assymmetry. For interlandmark
distances, we averaged bilateral measurements within each individual.
For both Procrustes residuals and local shape variables, we follow the
procedure outlined in Klingenberg et al. (2002) for bilateral structures
by obtaning for each individual a symmetrical landmark configuration,
averaging each actual shape with its reflection along the sagittal
plane; we estimate local shape variables afterwards. With respect to
Procrustes residuals, landmarks placed along the sagittal plane will
have zero variation in the direction normal to this plane; we aligned
all specimens' sagittal plane to the $xz$ plane, thus removing the $y$
component for each of these landmarks from covariance/correlation
matrices.

For each dataset, we estimated covariance and correlation matrices after
removing fixed effects of little interest in the present context, such
as sexual dimorphism, for example. For interlandmark distances and local
shape variables, these effects were removed through a multivariate
linear model adjusted for each species, according to
\autoref{tab:modcomp_otu}; for Procrustes residuals, the same effects
were removed by centering all group means to each species' mean shape,
since the loss of degrees of freedom imposed by the GPA prohibits the
use of a full multivariate linear model over this kind of data to
removed fixed effects.

In order to consider the effects of size variation over modularity
patterns, we used a different procedure to remove the influence of size,
according to the different properties of each type of variable. For
interlandmark distances, we use the approach established by Bookstein et
al. (1985); if $\mathbf{C}$ is a correlation matrix, we obtain a
correlation matrix $\mathbf{R}$ without the effect of size using the
equation \[
\mathbf{R} = \mathbf{C} - \lambda_1 v_1 v^{t}_1
\] where $\lambda_1$ and $v_1$ refer respectively to the first
eigenvalue and eigenvector of the spectral decomposition of $C$,
considering that this eigenvector is associated with size variation, a
common pattern in mammalian correlation structure, especially when
interlandmark distances are considered (Wagner, 1984; Mitteroecker
\emph{et al.}, 2004; Mitteroecker \& Bookstein, 2007); $t$ denotes
matrix transpose. For Procrustes residuals and local shape variables,
the effects of isometric variation are removed prior through normalizing
each individual to unit centroid size. However, allometric effects still
influence covariance or correlation structure. In order to remove such
effects, we use a similar procedure, based upon Mitteroecker et al.
(2004), which involves the estimation of an allometric component for
each OTU; this allometric component is related to regression coefficents
for each of the $m$ shape variables (either Procrustes residuals or
local shape variables) over log Centroid Size. If $\mathbf{S}$ is a
covariance matrix, we obtain a covariance matrix $\mathbf{R}$ without
the influence of allometric relationships using the equation \[
\mathbf{R} = (I_m - aa^t) \mathbf{S} (I_m - aa^t)
\] where $a$ refers to the normalized allometric component estimated for
each OTU and $I_m$ represents the identity matrix of size $m$.
Therefore, our empirical dataset consists of six different sets of
covariance/correlation matrices, considering both the nature of
morphometric variables and the presence or absence of variation
associated with size.

\subsection{Empirical Modularity Hypothesis
Tests}\label{empirical-modularity-hypothesis-tests}

Using these six sets of covariance/correlation matrices, we test the
hypotheses of trait associations described in both \autoref{tab:lms} for
Procrustes residuals and \autoref{tab:dist} for interlandmark distances
and local shape variables. These trait sets are grouped with respect to
their scope; two regional sets (Face and Neurocranium), each divided
into three more localized trait sets (Oral, Nasal and Zygomatic for the
Face; Orbit, Base and Vault for the Neurocranium).

For all hypotheses, we estimate both AVG Indexes (Porto \emph{et al.},
2013) and the RV coefficients (Klingenberg, 2009). Both statistics are
estimated by partitioning any given covariance or correlation matrix
into blocks; if $\mathbf{A}$ is a covariance or correlation matrix, the
partition \[
\mathbf{A} =
\begin{bmatrix}
\mathbf{A}_h & \mathbf{A}_b \\
\mathbf{A}^t_b & \mathbf{A}_c
\end{bmatrix}
\] indicates that the block $\mathbf{A}_h$ contains covariances or
correlations between traits that belong to the trait set being
considered, while $\mathbf{A}_c$ represents the complementary set;
$\mathbf{A}_b$ represents the block of covariances or correlations
between the two sets. Thus, covariance ($\mathbf{S}$) or correlation
($\mathbf{C}$) matrices can be partitioned into a similar scheme. We
estimate AVG Indexes using the equation \[
AVGi = \frac {\bar{\rho}_{+} - \bar{\rho}_{-}} {ICV}
\] where $\bar{\rho}_{+}$ represents the average correlation in
$\mathbf{C}_h$, $\bar{\rho}_{-}$ represents the average correlation of
the complementary set (correlations in both $\mathbf{C}_b$ and
$\mathbf{C}_c$), and $ICV$ is the coefficient of variation of
eigenvalues of the covariance matrix, which is a measurement of the
overall integration between all traits (Shirai \& Marroig, 2010). We
estimate RV coefficients for each hypothesis using the relationship \[
RV = \frac{tr(\mathbf{S}_{b}\mathbf{S}^t_{b})}{\sqrt{tr(\mathbf{S}_h \mathbf{S}_h)tr(\mathbf{S}_c \mathbf{S}_c)}}
\] where $tr$ represents the sum of diagonal elements in any given
matrix ($tr \mathbf{A} = \sum_i a_{ii}$).

The partitioning scheme outlined above assumes that the complementary
set does not represent an actual hypothesis of trait association;
however, we may choose to consider that both sets ($\mathbf{A}_h$ and
$\mathbf{A}_c$) represent two distinct hypothesis. The estimation of RV
coefficients remains the same; however, AVG Indexes are estimated
considering that $\bar{\rho}_{+}$ is the average correlation in both
$\mathbf{C}_h$ and $\mathbf{C}_c$, while $\bar{\rho}_{-}$ represents the
average correlation only in $\mathbf{C}_b$. In the particular case of
the distinction between Facial and Neurocranial traits, we also
estimated AVG Indexes in this manner, reporting values for this estimate
under the denomination `Neuroface', following Marroig \& Cheverud
(2001), along independent AVGi estimates for each region. Furthermore,
since both Face and Neurocranium are two disjoint trait sets when any
morphometric variable type is considered, RV coefficient values for
either set are equal; therefore, a single RV value is reported for both
regions, for each variable type.

In order to test the hypothesis that each trait set represent
variational modules, we used a randomization procedure that generates
1000 random trait sets with the same size as the original set,
calculating both AVGi and RV values for each generated set. These values
are used to construct distributions for both statistics that represent
the null hypothesis that a hypothetical trait set is a random
arrangement without meaningful relationships. The value obtained for the
real trait set is then compared to this distribution. In the case of
AVGi, we consider that this null hypothesis is rejected when the real
value is higher than the average value for the null distribution,
considering the significance level established; in the case of RV
coefficient, the null hypothesis is rejected when the real RV value is
lower than the average value for the distribution, also considering a
certain significance level. For Procrustes residuals, the randomization
procedure considers that coordinates within the same landmark should
remain together in each randomly generated trait set, following
Klingenberg \& Leamy (2001).

It is noteworthy that, while the procedure for estimating significance
in the case of AVG Indexes is derived from Mantel's (1967) approach (as
outlined by Cheverud \emph{et al.}, 1989), we chose to generate null
distributions for AVGi directly, instead of estimating matrix
correlation values for both real and permutated matrices. Estimated
$p$-values in both cases remain the same, and the additional step of
estimating matrix correlations would produce an unnecessary difference
between the estimation of signficance for AVGi and RV.

\subsection{Estimation of Error Rates}\label{estimation-of-error-rates}

In order to evaluate the statistical properties of both statistics and
the randomization procedure, we built theoretical correlation matrices
\[
\mathbf{C}_{s} =
\begin{bmatrix}
\mathbf{W}_1 & \mathbf{B} \\
\mathbf{B}^t & \mathbf{W}_2 \\
\end{bmatrix}
\] where $\mathbf{W}_1$ and $\mathbf{W}_2$ represent correlation blocks
associated with two distinct trait sets, and $\mathbf{B}$ represents the
correlation block between both sets.

For each set of empirical correlation matrices used in the previous
section, we obtained average correlation distributions within and
between the trait sets considered (\autoref{fig:cor_dist}). We
constructed corresponding sets of $\mathbf{C}_{s}$ matrices by sampling
each distribution; for each matrix, we sampled two within-set
correlations and one between-set correlation, filling the corresponding
block in the theoretical matrix with the sampled correlations. As an
example with only four traits, divided into two blocks of two traits, if
we sample the values $0.5$ and $0.3$ from the within-set distribution,
and $-0.1$ from the between-set distribution, the corresponding
$\mathbf{C}_{s}$ matrix will be \[
\mathbf{C}_s =
\begin{bmatrix}
1 & 0.5 & -0.1 & -0.1 \\
0.5 & 1 & -0.1 & -0.1 \\
-0.1 & -0.1 & 1 & 0.3 \\
-0.1 & -0.1 & 0.3 & 1 \\
\end{bmatrix}
\] filling each cell in each block with the sampled correlation
associated with that particular block. Thus, we abstract each type of
morphometric variable to a correlation distribution, building
theoretical correlation matrices that are representative of each type
retaining their statistical properties.

\begin{figure}[htbp]
\centering
\includegraphics{Figures/cor_dist-1.pdf}
\caption{Distribution of within-set and between-set correlations derived
from the six types of empirical correlation matrices.
\label{fig:cor_dist}}
\end{figure}

For each of the six pairs of correlation distributions, we built 1000
theoretical correlation matrices for 40 traits; previous tests indicate
that matrix dimensionality does not affect any of our results. We
considered only positive-definite matrices; if any given matrix did not
fit this criterion, we discarded that matrix and sampled a new set of
correlations. This allows us to sample observations from a multivariate
normal distribution using each of these 6000 matrices as the $\Sigma$
parameter. For each matrix, we also sample the size of both trait sets;
we established a minimal value of five traits for the size of any set.

We use this set of 6000 correlation matrices of known structure
($\mathbf{C}_s$) to built another set of correlation matrices of
unknown, random structure ($\mathbf{C}_r$) by simply shuffling both
lines and columns of each matrix; therefore, each $\mathbf{C}_r$ matrix
is associated with a $\mathbf{C}_s$ matrix. For all matrices, both
$\mathbf{C}_r$ and $\mathbf{C}_s$, we obtained samples of increasing
size (20, 40, 60, 80, 100 individuals) and re-estimated a correlation
matrix for each sample, thus also considering in our tests the
uncertainty derived from sampling. For each matrix estimated, both
$\mathbf{C}_r$ and $\mathbf{C}_s$, we test the hypothesis that the two
sets used to generate each $\mathbf{C}_s$ matrix represent two
variational modules, using both AVGi and RV coefficients, as described
in the previous section.

The case in which samples were generated from a $\mathbf{C}_r$ matrix
represents a situation of a true null hypothesis for either tests, since
the correlation matrix used to produce the sample was generated by a
permutation of the hypothesis being tested. Therefore, testing
hypotheses over $\mathbf{C}_r$ matrices allows us to estimate Type I
error rates for both tests, that is, the proportion of cases in which
the null hypothesis is rejected even though it is false, given a
significance level. In an adequate test, we expect that both quantities,
significance level and Type I error rate, will be identical.

The opposite case, when we sampled $\mathbf{C}_s$ matrices, represents a
situation in which we know that the null hypothesis of either tests is
false, since we are testing the hypothesis that the partitioning scheme
used to generate that particular matrix actually represents two
variational modules. Thus, we estimated, in this case, the Type II error
rates, that is, the probability that the null hypothesis is not rejected
even though it is false, given a significance level; here, we represent
Type II error using the power for each test, by simply calculating the
complementar probability to Type II error rate. In an adequate test, we
expect that power will rapidly reach a plateau when significance level
is still close to zero, and further increasing $P(\alpha)$ will not
produce a great increase in power.

Our estimations of power for both statistics should also be controlled
for effect size, since sampled correlations may generate a correlation
structure that is not detected simply due to small differences between
within-set and between-set correlations. For each correlation matrix
sampled, we keep the squared between-set correlation ($b^2$), in order
to use it as an estimate of effect size that is not directly associated
with either AVGi and RV statistics. We expect that power for either
tests will decrease with increasing $b^2$ values, as effect size would
also decrease.

\subsubsection{Software}\label{software}

All analysis were performed under R 3.2.0 (R Core Team, 2015). Source
code for all analyses can be found at \url{http://github.com/wgar84}. It
is noteworthy that previous tests we made indicated no differences
between our estimation of empirical RV coefficients, based upon our own
code, and estimates provided by MorphoJ (Klingenberg, 2011). In order to
obtain symmetrical landmarks configurations, we used code provided by
Annat Haber, available at
\url{http://life.bio.sunysb.edu/morph/soft-R.html}.

\section{Results}\label{results}

\subsection{Empirical Tests}\label{empirical-tests}

Regarding localized trait sets, tests performed using AVG Indexes
(\autoref{fig:MI_Func}) detect a consistent pattern among OTUs for both
interlandmark distances and local shape variables; in the first set, the
Oral sub-region is detected as a modular partition, and, when size is
removed, the Vault sub-region is also detected; both Orbit and Base
region are not detected in any of the tests with this type of variable.
With local shape variables, both Oral and Vault sets are also detected
consistently across OTUs, along Nasal and Zygomatic traits; moreover,
the removal of allometric variation affect only the detection of the
Vault. Notably, the Base sub-region is detected only in 3 of 42 tests.
For Procrustes residuals, the pattern of detection among sub-regions and
OTUs is diffuse; it is noteworthy that the Base sub-region is detected
among several OTUs, which contrasts this type of morphometric variable
with the remaining two types. Furthermore, abstracting the actual tests
performed, \autoref{fig:MI_Func} also indicates that Procrustes
residuals display a low variance for AVGi values within each OTU, while
both interlandmark distances and local shape variables display a
consistent pattern of variation among AVGi values within each OTU, with
lower values for the Base and, for interlandmark distances, Orbit trait
sets.

\begin{figure}[htbp]
\centering
\includegraphics{Figures/MI_Func-1.pdf}
\caption{AVG Index values for localized trait sets. Circles indicate
whether a trait set is recognized as a variational module in a given
OTU, with $P(\alpha)$ indicated by the legend. \label{fig:MI_Func}}
\end{figure}

Tests performed using RV coefficients (\autoref{fig:RV_Func}) show a
more diffuse pattern among each varible type. When interlandmark
distances are considered, most tests detect the Vault sub-region with
size variation retained, and the Base sub-region when size variation is
removed. For Procrustes residuals, few tests are able to reject their
null hypothesis, detecting only a handful of valid modular partitions.
Tests performed on local shape variables display the opposite behavior:
almost all partitions are detected, regardless of whether allometric
variation has been retained or removed. Moreover, RV values display a
pattern of marked variation among OTUs, more so than between values
within each OTU; notably, \emph{Macaca fascicularis} and \emph{Papio
anubis} show RV values much higher than those estimated on remaining
species. This pattern can be observed both on interlandmark distances
with size retained and in Procrustes residuals, although this effect is
more marked in the former type.

\begin{figure}[htbp]
\centering
\includegraphics{Figures/RV_Func-1.pdf}
\caption{RV Coefficient values for localized trait sets. Circles
indicate whether a trait set is recognized as a variational module in a
given OTU, with $P(\alpha)$ indicated by the legend.
\label{fig:RV_Func}}
\end{figure}

With respect to regional trait sets, tests performed using AVGi
(\autoref{fig:MI_Dev}) indicate a pattern consistent with the findings
regarding localized sets (\autoref{fig:MI_Func}). Considering only
interlandmark distances, Facial traits are detected as a valid modular
partition both with size variation retained or removed, while
Neurocranial traits are detected as a valid partition only when size
variation is removed. This pattern mirrors the contrast between Oral and
Vault traits in the localized sets regarding interlandmark distances.
Considering Procrustes residuals, Neurocranial traits are a valid
partition with both size retained and removed; once again, this pattern
mirrors the detection of the Basicranial partition as valid in the
localized sets. Finally, in local shape variables, both Face and
Neurocranium are detected as valid with size retained; with size
removed, only the Face is recognized. The same can be observed in the
localized sets, where removing allometric variation affects the
detection of the Vault set. The tests for distinction between within-set
and between-set correlations for these two sets (designated `Neuroface')
show a pattern that is consistent with tests for the individual sets,
that is, if one of the sets was previously detected, this distinction is
also detected as valid with high probability.

\begin{figure}[htbp]
\centering
\includegraphics{Figures/MI_Dev-1.pdf}
\caption{AVG Index values for regional trait sets. Circles indicate
whether a trait set is recognized in a given OTU, with $P(\alpha)$
indicated by the legend. \label{fig:MI_Dev}}
\end{figure}

Tests performed for this distinction between Face and Neurocranium using
RV coefficients (\autoref{fig:RV_Dev}) show that in most cases, for both
interlandmark distances and local shape variables, both regions are
considered distinct and valid variational modules; in Procrustes
residuals, only in a handful of taxa the same result can be observed. In
this case, the correspondence with results for localized trait sets
(\autoref{fig:RV_Func}) is more difficult, due to the lack of
independent tests for each region.

\begin{figure}[htbp]
\centering
\includegraphics{Figures/RV_Dev-1.pdf}
\caption{RV Coefficient values for regional trait sets. Circles indicate
whether a trait set is recognized in a given OTU, with $P(\alpha)$
indicated by the legend. \label{fig:RV_Dev}}
\end{figure}

\subsection{Error Rates}\label{error-rates}

Comparing the distributions of AVGi and RV values from theoretical
matrices with respect to their structure (\autoref{fig:stat_dist_sim})
shows marked differences between statistics and morphometric variables
from which correlations are sampled. For local shape variables, the
distribution of both AVGi and RV values for $\mathbf{C}_s$ and
$\mathbf{C}_r$ matrices overlap very little; for interlandmark
distances, the distribution of AVGi values for both matrix types also
has little overlap, while the same distributions for RV have a
substantial overlap. Finally, for Procrustes residuals, while the
distribution of AVGi values for both matrix types are overlapping to
some degree, the same distributions for RV values are identical. It is
noteworthy that removing size or allometry does not change these
distributions in most cases; only for RV values estimated over matrices
derived from correlation distributions for interlandmark distances, in
which the removal of size variation increases the overlap in
$\mathbf{C}_s$ and $\mathbf{C}_r$ distributions.

\begin{figure}[htbp]
\centering
\includegraphics{Figures/stat_dist_sim-1.pdf}
\caption{Distribution of AVG Index and RV Coefficient for theoretical
correlation matrices. \label{fig:stat_dist_sim}}
\end{figure}

Regarding the relationship between significance levels and Type I error
rates, estimated over $\mathbf{C}_r$ matrices, \autoref{fig:type1} shows
that these quantities approach an identity relationship very closely,
regardless of whether we use AVGi or RV to quantify variational
modularity; even at low sample sizes, Type I error rates are very close
to significance levels. Furthermore, the effect of sampling correlations
from size-free distributions does not alter Type I error rates for both
tests.

\begin{figure}[htbp]
\centering
\includegraphics{Figures/type1-1.pdf}
\caption{Type I error rates as a function of the chosen significance
level regarding tests for variational modularity applied on
$\mathbf{C}_r$ correlation matrices. The solid black line represents the
identity relationship. \label{fig:type1}}
\end{figure}

When we consider the relationship between power and significance levels,
estimated over $\mathbf{C}_s$ matrices, there are substantial
differences with respect both to the chosen statistic (AVGi or RV) and
to the type of variable from which correlations are sampled. Considering
local shape variables (\autoref{fig:type2_def}), tests using either AVGi
and RV have high power, even at low sample or effect sizes; increasing
these quantities produces a further increase in power. However, it is
noteworthy that, for lower effect sizes (represented by high average
squared correlation between sets, $b^2$) power for tests performed using
AVGi is higher than for those using RV. As effect size increases (lower
$b^2$ values), the difference in power between the two statistics
decreases. For this type of variable, sampling from its associated
size-free correlation distribution implies minor differences in power
for both statistics.

\begin{figure}[htbp]
\centering
\includegraphics{Figures/type2_def-1.pdf}
\caption{Power for both AVGi and RV statistics as a function of the
chosen significance levels with respect to tests for variational
modularity applied on $\mathbf{C}_s$ matrices with values sampled from
the distribution of correlations between local shape variables. Lines
are colored with respect to quantiles of the $b^2$ distribution,
according to the legend. \label{fig:type2_def}}
\end{figure}

For interlandmark distances (\autoref{fig:type2_ed}), there are
substantial differences on the relationship between power and
significance level if we consider the different parameters. First and
foremost, the effect of sampling from the size-free correlation
distribution in order to build $\mathbf{C}_s$ matrices produces a
substantial decrease in power for either tests; however, this decrease
is more pronounced for tests based on the RV statistic, since for lower
effect sizes (high $b^2$ values), power approaches an identity
relationship with significance level. Sample size also interferes with
this relationship, as increasing this quantity also increases power when
higher effect sizes (low $b^2$ values) are considered.

\begin{figure}[htbp]
\centering
\includegraphics{Figures/type2_ed-1.pdf}
\caption{Power for both AVGi and RV statistics as a function of the
chosen significance levels with respect to tests for variational
modularity applied on $\mathbf{C}_s$ correlation matrices with values
sampled from the distribution of correlations between interlandmark
distances. Lines are colored with respect to quantiles of the $b^2$
distribution, according to the legend. The solid black line represents
the identity relationship. \label{fig:type2_ed}}
\end{figure}

With respect to Procrustes residuals (\autoref{fig:type2_sym}), tests
using either AVGi or RV have reduced power, regardless of effect or
sample size. Sampling from size-free correlation distributions to build
$\mathbf{C}_s$ matrices also has little effect. As for interlandmark
distances without size variation, power for tests performed using RV
values approach an identity relationship with significance level;
however, increasing sample size has little effect in this case.

\begin{figure}[htbp]
\centering
\includegraphics{Figures/type2_sym-1.pdf}
\caption{Power for both AVGi and RV statistics as a function of the
chosen significance levels with respect to tests for variational
modularity applied on $\mathbf{C}_s$ matrices with values sampled from
the distribution of correlations between Procrustes residuals. Lines are
colored with respect to quantiles of the $b^2$ distribution, according
to the legend. The solid black line represents the identity
relationship. \label{fig:type2_sym}}
\end{figure}

\section{Discussion}\label{discussion}

\section*{References}\label{references}
\addcontentsline{toc}{section}{References}

Bookstein, F.L. 1991. \emph{Morphometric tools for landmark data:
geometry and biology}. Cambridge University Press, Cambridge.

Bookstein, F.L., Chernoff, B., Elder, R., Humphries, Smith, G. \&
Strauss, R. 1985. \emph{Morphometrics in Evolutionary Biology}. The
Academy of Natural Sciences of Philadelphia, Philadelphia.

Cheverud, J.M. 1996. Developmental integration and the evolution of
pleiotropy. \emph{American Zoology} \textbf{36}: 44--50.

Cheverud, J.M., Wagner, G.P. \& Dow, M.M. 1989. Methods for the
comparative analysis of variation patterns. \emph{Evolution}
\textbf{38}: 201--213.

Klingenberg, C.P. 2011. MorphoJ: an integrated software package for
geometric morphometrics. \emph{Molecular Ecology Resources} \textbf{11}:
353--357.

Klingenberg, C.P. 2008. Morphological Integration and Developmental
Modularity. \emph{Annual Review of Ecology, Evolution, and Systematics}
\textbf{39}: 115--132.

Klingenberg, C.P. 2009. Morphometric integration and modularity in
configurations of landmarks: tools for evaluating a priori hypotheses.
\emph{Evolution \& Development} \textbf{11}: 405--421.

Klingenberg, C.P. \& Leamy, L.J. 2001. Quantitative genetics of
geometric shape in the mouse mandible. \emph{Evolution} \textbf{55}:
2342--2352.

Klingenberg, C.P., Barluenga, M. \& Meyer, A. 2002. Shape analysis of
symmetric structures: Quantifying variation among individuals and
asymmetry. \emph{Evolution} \textbf{56}: 1909--1920.

Mantel, N. 1967. The detection of disease clustering and a generalized
regression approach. \emph{Cancer Res} \textbf{27}: 209--220.

Marroig, G. \& Cheverud, J.M. 2001. A comparison of phenotypic variation
and covariation patterns and the role of phylogeny, ecology, and
ontogeny during cranial evolution of new world monkeys. \emph{Evolution}
\textbf{55}: 2576--2600.

Márquez, E.J., Cabeen, R., Woods, R.P. \& Houle, D. 2012. The
Measurement of Local Variation in Shape. \emph{Evolutionary Biology}
\textbf{39}: 419--439.

Mitteroecker, P. \& Bookstein, F.L. 2007. The conceptual and statistical
relationship between modularity and morphological integration.
\emph{Systematic Biology} \textbf{56}: 818--836.

Mitteroecker, P., Gunz, P., Bernhard, M., Bookstein, F.L. \& Schaefer,
K. 2004. Comparison of cranial ontogenetic trajectories among great apes
and humans. \emph{Journal of Human Evolution} \textbf{46}: 679--697.

Newman, M.E.J. 2006. Modularity and community structure in networks.
\emph{Proceedings of the National Academy of Sciences} \textbf{103}:
8577--8582.

Oliveira, F.B., Porto, A. \& Marroig, G. 2009. Covariance structure in
the skull of Catarrhini: a case of pattern stasis and magnitude
evolution. \emph{Journal of Human Evolution} \textbf{56}: 417--430.

Polly, P.D. 2008. Developmental Dynamics and G-Matrices: Can
Morphometric Spaces be Used to Model Phenotypic Evolution?
\emph{Evolutionary Biology} \textbf{35}: 83--96.

Porto, A., Shirai, L.T., Oliveira, F.B. de \& Marroig, G. 2013. Size
Variation, Growth Strategies, and the Evolution of Modularity in the
Mammalian Skull. \emph{Evolution} \textbf{67}: 3305--3322.

R Core Team. 2015. \emph{R: A Language and Environment for Statistical
Computing}. R Foundation for Statistical Computing, Vienna, Austria.

Shirai, L.T. \& Marroig, G. 2010. Skull modularity in neotropical
marsupials and monkeys: size variation and evolutionary constraint and
flexibility. \emph{Journal of experimental zoology. Part B, Molecular
and developmental evolution} \textbf{314B}: 663--683.

Wagner, G.P. 1996. Homologues, natural kinds and the evolution of
modularity. \emph{The American Zoologist} \textbf{36}: 36--43.

Wagner, G.P. 1984. On the eigenvalue distribution of genetic and
phenotypic dispersion matrices: evidence for a nonrandom organization of
quantitative character variation. \emph{Journal of Mathematical Biology}
\textbf{21}: 77--95.

Wagner, G.P., Pavlicev, M. \& Cheverud, J.M. 2007. The road to
modularity. \emph{Nature reviews. Genetics} \textbf{8}: 921--931.

Zelditch, M.L., Swiderski, D.L., Sheets, H.D. \& Fink, W.L. 2004.
\emph{Geometric Morphometrics for Biologists: A Primer}, 1st ed.
Elsevier.

\end{document}
