---
title: "Type I and II Error Rates in Modularity Hypothesis Testing"
output:
  pdf_document:
    includes:
      in_header: Tex/modcomp_head.tex
      before_body: Tex/chap_info.tex
    fig_caption: true
    keep_tex: true
  word_document:
    fig_caption: true
    fig_width: 6
fontsize: 12pt
csl: Bib/journal-of-evolutionary-biology.csl
bibliography: Bib/modcomp.bib
---	

Guilherme Garcia^1,2^, Gabriel Marroig^1^

^1^Laboratório de Evolução de Mamíferos, Departamento de Genética e Biologia Evolutiva, Instituto de Biociências, Universidade de São Paulo, CP 11.461, CEP 05422-970, São Paulo, Brasil

^2^<wgar@usp.br>

running title: Error in Modularity Hypothesis Testing

key words: 

```{r options_modcomp, include = FALSE}
opts_chunk $ set (fig.path = 'Figures/', dev = 'pdf')
```

```{r captions_modcomp, include = FALSE}
captions $ fig.cor_dist <-
  'Distribution of within-set and between-set correlations derived from the six types of empirical correlation matrices. \\label{fig:cor_dist}'

captions $ fig.stat_dist_sim <-
  'Distribution of AVG Index and RV Coefficient for theoretical correlation matrices. \\label{fig:stat_dist_sim}'

captions $ fig.MI_Func <-
  'AVG Index values for localized trait sets. Circles indicate whether a trait set is recognized as a variational module in a given OTU, with $P(\\alpha)$ indicated by the legend. \\label{fig:MI_Func}'

captions $ fig.RV_Func <-
  'RV Coefficient values for localized trait sets. Circles indicate whether a trait set is recognized as a variational module in a given OTU, with $P(\\alpha)$ indicated by the legend. \\label{fig:RV_Func}'

captions $ fig.MI_Dev <-
  'AVG Index values for regional trait sets. Circles indicate whether a trait set is recognized in a given OTU, with $P(\\alpha)$ indicated by the legend. \\label{fig:MI_Dev}'

captions $ fig.RV_Dev <-
  'RV Coefficient values for regional trait sets. Circles indicate whether a trait set is recognized in a given OTU, with $P(\\alpha)$ indicated by the legend. \\label{fig:RV_Dev}'

captions $ fig.type1 <-
  'Type I error rates as a function of the chosen significance level regarding tests for variational modularity applied on $\\mathbf{C}_r$ correlation matrices. The solid black line represents the identity relationship. \\label{fig:type1}'

captions $ fig.type2_ed <-
  'Power for both AVGi and RV metrics as a function of the chosen significance levels with respect to tests for variational modularity applied on $\\mathbf{C}_s$ correlation matrices with values sampled from the distribution of correlations between interlandmark distances. Lines are colored with respect to quantiles of the $b^2$ distribution, according to the legend. The solid black line represents the identity relationship. \\label{fig:type2_ed}'

captions $ fig.type2_def <-
    'Power for both AVGi and RV metrics as a function of the chosen significance levels with respect to tests for variational modularity applied on $\\mathbf{C}_s$ matrices with values sampled from the distribution of correlations between local shape variables. Lines are colored with respect to quantiles of the $b^2$ distribution, according to the legend. \\label{fig:type2_def}'

captions $ fig.type2_sym <-
  'Power for both AVGi and RV metrics as a function of the chosen significance levels with respect to tests for variational modularity applied on $\\mathbf{C}_s$ matrices with values sampled from the distribution of correlations between Procrustes residuals. Lines are colored with respect to quantiles of the $b^2$ distribution, according to the legend. The solid black line represents the identity relationship. \\label{fig:type2_sym}'

```

# Introduction

In the present work, we compare the methods described both by @cheverud_methods_1989 and @klingenberg_morphometric_2009 to test *a priori* defined modularity patterns, using Anthropoid primates as a model organism. In order to also compare the performance of these methods with respect to different representations of form, sample units are represented both as interlandmark distances and shape variables. Furthermore, we also used an approach based on the construction of theoretical correlation matrices; in this context, these matrices are used in order to estimate Type I and Type II error rates for both methods. Since these methods were designed under different frameworks, the present work also puts some effort into unifying both methods into the same conceptual and statistical framework, in order to produce a more meaningful comparison.

# Methods

## Sample

The database used here (\autoref{tab:modcomp_otu}) consists of 21 species, distributed across all taxonomic denominations of Anthropoidea above the genus level. These OTUs were selected from a broader database [@marroig_comparison_2001; @oliveira_covariance_2009] in order to reduce the effects of low sample sizes over estimates of modularity patterns. Individuals in our sample are represented by 36 registered landmarks, using either a Polhemus 3Draw or a Microscribe 3DS for Platyrrhini and Catarrhini, respectively. Twenty-two unique landmarks represent each individual (\autoref{fig:landmarks}, \autoref{tab:lms}), since 14 of the 36 registered landmarks are bilaterally symmetrical. For more details on landmark registration, see @marroig_comparison_2001 and @oliveira_covariance_2009.

\input{Tables/modcomp_otu}

For each OTU, we estimated phenotypic covariance and correlation matrices for three different types of variables: tangent space residuals, estimated from a Procrustes superimposition for the entire sample, using the set of landmarks described on both \autoref{tab:lms} and \autoref{fig:landmarks} (henceforth refered to as Procrustes residuals); interlandmark distances, as described in \autoref{tab:dist}; and local shape variables [@marquez_measurement_2012], which are measurements of infinitesimal log volume transformations between each sample unit and a reference (mean) shape. These transformations were calculated at 38 points, corresponding to the locations of the mipoints between pairs of landmarks used to calculate interlandmark distances, in order to produce a dataset that represents shape [i.e., form without isometric variation; @bookstein_morphometric_1991; @zelditch_geometric_2004] while retaining the same overall properties of the interlandmark distance dataset, such as dimensionality, for instance. Furthermore, the same hypotheses of trait association can be used on both types of variables since the position of local shape variables through the skull mirrors the position of interlandmark distances, although they are conceptually different types of measurements.

Here we consider only covariance or correlation structure for the symmetrical component of variation; therefore, prior to any analysis, we need to control for variation in assymmetry. For interlandmark distances, we averaged bilateral measurements within each individual. For both Procrustes residuals and local shape variables, we follow the procedure outlined in @klingenberg_shape_2002 for bilateral structures by obtaning for each individual a symmetrical landmark configuration, averaging each actual shape with its reflection along the sagittal plane; we estimate local shape variables afterwards. With respect to Procrustes residuals, landmarks placed along the sagittal plane will have zero variation in the direction normal to this plane; we aligned all specimens' sagittal plane to the $xz$ plane, thus removing the $y$ component for each of these landmarks from covariance/correlation matrices.

For each dataset, we estimated covariance and correlation matrices after removing fixed effects of little interest in the present context, such as sexual dimorphism, for example. For interlandmark distances and local shape variables, these effects were removed through a multivariate linear model adjusted for each species, according to \autoref{tab:modcomp_otu}; for Procrustes residuals, the same effects were removed by centering all group means to each species' mean shape, since the loss of degrees of freedom imposed by the GPA prohibits the use of a full multivariate linear model over this kind of data to removed fixed effects.

In order to consider the effects of size variation over modularity patterns, we used a different procedure to remove the influence of size, according to the different properties of each type of variable. For interlandmark distances, we use the approach established by @bookstein_morphometrics_1985; if $\mathbf{C}$ is a correlation matrix, we obtain a correlation matrix $\mathbf{R}$ without the effect of size using the equation
$$
\mathbf{R} = \mathbf{C} - \lambda_1 v_1 v^{t}_1
$$
where $\lambda_1$ and $v_1$ refer respectively to the first eigenvalue and eigenvector of the spectral decomposition of $C$, considering that this eigenvector is associated with size variation, a common pattern in mammalian correlation structure, especially when interlandmark distances are considered [@wagner_eigenvalue_1984; @mitteroecker_comparison_2004; @mitteroecker_conceptual_2007]; $t$ denotes matrix transpose. For Procrustes residuals and local shape variables, the effects of isometric variation are removed prior through normalizing each individual to unit centroid size. However, allometric effects still influence covariance or correlation structure. In order to remove such effects, we use a similar procedure, based upon @mitteroecker_comparison_2004, which involves the estimation of an allometric component for each OTU; this allometric component is related to regression coefficents for each of the $m$ shape variables (either Procrustes residuals or local shape variables) over log Centroid Size. If $\mathbf{S}$ is a covariance matrix, we obtain a covariance matrix $\mathbf{R}$ without the influence of allometric relationships using the equation
$$
\mathbf{R} = (I_m - aa^t) \mathbf{S} (I_m - aa^t)
$$
where $a$ refers to the normalized allometric component estimated for each OTU and $I_m$ represents the identity matrix of size $m$. Therefore, our empirical dataset consists of six different sets of covariance/correlation matrices, considering both the nature of morphometric variables and the presence or absence of variation associated with size.

## Empirical Modularity Hypothesis Tests

Using these six sets of covariance/correlation matrices, we test the hypotheses of trait associations described in both \autoref{tab:lms} for Procrustes residuals and \autoref{tab:dist} for interlandmark distances and local shape variables. These trait sets are grouped with respect to their scope; two regional sets (Face and Neurocranium), each divided into three more localized trait sets (Oral, Nasal and Zygomatic for the Face; Orbit, Base and Vault for the Neurocranium). 

For each hypothesis, we estimate both the AVG Index [@porto_size_2013] and the RV coefficient [@klingenberg_morphometric_2009]. Both indexes are estimated by partitioning any given covariance or correlation matrix into blocks; if $\mathbf{A}$ is a covariance or correlation matrix, the partition
$$
\mathbf{A} =
\begin{bmatrix}
\mathbf{A}_h & \mathbf{A}_b \\
\mathbf{A}^t_b & \mathbf{A}_c
\end{bmatrix}
$$
indicates that the block $\mathbf{A}_h$ contains covariances or correlations between traits that belong to the trait set being considered, while $\mathbf{A}_c$ represents the complementary set; $\mathbf{A}_b$ represents the block of covariances or correlations between the two sets. Thus, covariance ($\mathbf{S}$) or correlation ($\mathbf{C}$) can be partitioned into a similar scheme. We estimate AVG Indexes using the equation
$$
AVGi = \frac {\bar{\rho}_{+} - \bar{\rho}_{-}} {ICV}
$$
where $\bar{\rho}_{+}$ represents the average correlation in $\mathbf{C}_h$, $\bar{\rho}_{-}$ represents the average correlation of the complementary set (correlations in both $\mathbf{C}_b$ and $\mathbf{C}_c$), and $ICV$ is the coefficient of variation of eigenvalues of the covariance matrix, which is a measurement of the overall integration between all traits [@shirai_skull_2010]. We estimate RV coefficients for each hypothesis using the relationship
$$
RV = \frac{tr(\mathbf{S}_{b}\mathbf{S}^t_{b})}{\sqrt{tr(\mathbf{S}_h \mathbf{S}_h)tr(\mathbf{S}_c \mathbf{S}_c)}}
$$
where $tr$ represents the sum of diagonal elements in any given matrix ($tr \mathbf{A} = \sum_i a_{ii}$).

The partitioning scheme outlined above assumes that the complementary set does not represent an actual hypothesis of trait association; however, we may choose to consider that both sets ($\mathbf{A}_h$ and $\mathbf{A}_c$) represent two distinct hypothesis. The estimation of RV coefficients remains the same; however, AVG Indexes are estimated considering that $\bar{\rho}_{+}$ is the average correlation in both $\mathbf{C}_h$ and $\mathbf{C}_c$, while $\bar{\rho}_{-}$ represents the average correlation only in $\mathbf{C}_b$. In the particular case of the distinction between Facial and Neurocranial traits, we also estimate AVG Indexes in this manner, reporting values for this estimate under the denomination 'Neuroface', following @marroig_comparison_2001, along independent AVGi estimates for each region. Furthermore, since both Face and Neurocranium are two disjoint trait sets when any morphometric variable type is considered, RV coefficient values for either set are equal; therefore, a single RV value is reported for both regions, for each variable type.

In order to test the hypothesis that each trait set represent variational modules, we use a randomization procedure that generates 1000 random trait sets with the same size as the original set, calculating both AVGi and RV values for each generated set. These values are used to construct distributions for both metrics that represent the null hypothesis that a hypothetical trait set is a random arrangement without meaningful relationships. The value obtained for the real trait set is then compared to this distribution. In the case of AVGi, we consider that this null hypothesis is rejected when the real value is higher than the average value for the null distribution, considering the significance level established; in the case of RV coefficient, the null hypothesis is rejected when the real RV value is lower than the average value for the distribution, also considering a certain significance level. For Procrustes residuals, the randomization procedure considers that coordinates within the same landmark should remain together in each randomly generated trait set, following @klingenberg_quantitative_2001.

It is noteworthy that, while the procedure for estimating significance in the case of AVG Indexes is derived from Mantel's [-@mantel_detection_1967] approach [as outlined by @cheverud_methods_1989], we chose to generate null distributions for AVGi directly, instead of estimating matrix correlation values for both real and permutated matrices. Significance in both cases remain the same, and the additional step of estimating matrix correlations would produce an unnecessary difference between the estimation of signficance for AVGi and RV.

## Estimation of Error Rates

In order to evaluate the statistical properties of both metrics and the randomization procedure, we built theoretical correlation matrices
$$
\mathbf{C}_{s} =
\begin{bmatrix}
\mathbf{W}_1 & \mathbf{B} \\
\mathbf{B}^t & \mathbf{W}_2 \\
\end{bmatrix}
$$
where $\mathbf{W}_1$ and $\mathbf{W}_2$ represent correlation blocks associated with two distinct trait sets, and $\mathbf{B}$ represents the correlation block between both sets.

For each set of empirical correlation matrices used in the previous section, we obtained average correlation distributions within and between the trait sets considered (\autoref{fig:cor_dist}). We constructed corresponding sets of $\mathbf{C}_{s}$ matrices by sampling each distribution; for each matrix, we sampled two within-set correlations and one between-set correlation, filling the corresponding block in the theoretical matrix with the sampled correlations. As an example with only four traits, divided into two blocks of two traits, if we sample the values $0.5$ and $0.3$ from the within-set distribution, and $-0.1$ from the between-set distribution, the corresponding $\mathbf{C}_{s}$ matrix will be
$$
\mathbf{C}_s =
\begin{bmatrix}
1 & 0.5 & -0.1 & -0.1 \\
0.5 & 1 & -0.1 & -0.1 \\
-0.1 & -0.1 & 1 & 0.3 \\
-0.1 & -0.1 & 0.3 & 1 \\
\end{bmatrix}
$$
filling each cell in each block with the sampled correlation associated with that particular block. Thus, we abstract each type of morphometric variable to a correlation distribution, building theoretical correlation matrices that are representative of each type retaining their statistical properties.

```{r cor_dist, echo = FALSE, fig.cap = captions $ fig.cor_dist, fig.width = 9.6, fig.height = 10.8}
modsim.Plots $ cor.dist
```

For each of the six pairs of correlation distributions, we built 1000 theoretical correlation matrices for 40 traits; previous tests indicate that matrix dimensionality does not affect any of our results. We considered only positive-definite matrices; if any given matrix did not fit this criterion, we discarded that matrix and sampled a new set of correlations. This allows us to sample observations from a multivariate normal distribution using each of these 6000 matrices as the $\Sigma$ parameter. For each matrix, we also sample the size of both trait sets; we established a minimal value of five traits for the size of any set.

We use this set of 6000 correlation matrices of known structure ($\mathbf{C}_s$) to built another set of correlation matrices of unknown, random structure ($\mathbf{C}_r$) by simply shuffling both lines and columns of each matrix; therefore, each $\mathbf{C}_r$ matrix is associated with a $\mathbf{C}_s$ matrix. For all matrices, both $\mathbf{C}_r$ and $\mathbf{C}_s$, we obtained samples of increasing size (20, 40, 60, 80, 100 individuals) and re-estimated a correlation matrix for each sample, thus also considering in our tests the uncertainty derived from sampling. For each matrix estimated, both $\mathbf{C}_r$ and $\mathbf{C}_s$, we test the hypothesis that the two sets used to generate each $\mathbf{C}_s$ matrix represent two variational modules, using both AVGi and RV coefficients, as described in the previous section.

The case in which samples were generated from a $\mathbf{C}_r$ matrix represents a situation of a true null hypothesis for either tests, since the correlation matrix used to produce the sample was generated by a permutation of the hypothesis being tested. Therefore, testing hypotheses over $\mathbf{C}_r$ matrices allows us to estimate Type I error rates for both tests, that is, the proportion of cases in which the null hypothesis is rejected even though it is false, given a significance level. In an adequate test, we expect that both quantities, significance level and Type I error rate, will be identical.

The opposite case, when we sampled $\mathbf{C}_s$ matrices, represents a situation in which we know that the null hypothesis of either tests is false, since we are testing the hypothesis that the partitioning scheme used to generate that particular matrix actually represents two variational modules. Thus, we estimated, in this case, the Type II error rates, that is, the probability that the null hypothesis is not rejected even though it is false, given a significance level; here, we represent Type II error using the power for each test, by simply calculating the complementar probability to Type II error rate. In an adequate test, we expect that power will rapidly reach a plateau when significance level is still close to zero, and further increasing $P(\alpha)$ will not produce a great increase in power.

Our estimations of power for both metrics should also be controlled for effect size, since sampled correlations may generate a correlation structure that is not detected simply due to small differences between within-set and between-set correlations. For each correlation matrix sampled, we keep the squared between-set correlation ($b^2$), in order to use it as an estimate of effect size that is not directly associated with both AVGi and RV metrics. We expect that power for either tests will decrease with increasing $b^2$ values, as effect size would also decrease.

### Software

All analysis were performed under R `r paste (version $ major, version $ minor, sep = '.')` [@r_core_team_r:_2015]. Source code for all analyses can be found at <http://github.com/wgar84>. It is noteworthy that previous tests we made indicated no differences between our estimation of empirical RV coefficients, based upon our own code, and estimates provided by MorphoJ [@klingenberg_morphoj:_2011]. In order to obtain symmetrical landmarks configurations, we used code provided by Annat Haber, available at <http://life.bio.sunysb.edu/morph/soft-R.html>.

# Results

## Empirical Tests

Regarding localized trait sets, tests performed using AVG Indexes (\autoref{fig:MI_Func}) detect a consistent pattern among OTUs for both interlandmark distances and local shape variables; in the first set, the Oral sub-region is detected as a modular partition, and, when size is removed, the Vault sub-region is also detected; both Orbit and Base region are not detected in any of the tests with this type of variable. With local shape variables, both Oral and Vault sets are also detected consistently across OTUs, along Nasal and Zygomatic traits; moreover, the removal of allometric variation affect only the detection of the Vault. Notably, the Base sub-region is detected only in 3 of 42 tests. For Procrustes residuals, the pattern of detection among sub-regions and OTUs is diffuse; it is noteworthy that the Base sub-region is detected among several OTUs, which contrasts this type of morphometric variable with the remaining two types. Furthermore, abstracting the actual tests performed, \autoref{fig:MI_Func} also indicates that Procrustes residuals display a low variance for AVGi values within each OTU, while both interlandmark distances and local shape variables display a consistent pattern of variation among AVGi values within each OTU, with lower values for the Base and, for interlandmark distances, Orbit trait sets.

```{r MI_Func, echo = FALSE, fig.cap = captions $ fig.MI_Func, fig.width = 9.6, fig.height = 10.8}
modcomp.Plots $ MI.Func
```

Tests performed using RV coefficients (\autoref{fig:RV_Func}) show a more diffuse pattern among each varible type. When interlandmark distances are considered, most tests detect the Vault sub-region with size variation retained, and the Base sub-region when size variation is removed. For Procrustes residuals, few tests are able to reject their null hypothesis, detecting only a handful of valid modular partitions. Tests performed on local shape variables display the opposite behavior: almost all partitions are detected, regardless of whether allometric variation has been retained or removed. Moreover, RV values display a pattern of marked variation among OTUs, more so than between values within each OTU; notably, *Macaca fascicularis* and *Papio anubis* show RV values much higher than those estimated on remaining species. This pattern can be observed both on interlandmark distances with size retained and in Procrustes residuals, although this effect is more marked in the former type. 

```{r RV_Func, echo = FALSE, fig.cap = captions $ fig.RV_Func, fig.width = 9.6, fig.height = 10.8}
modcomp.Plots $ RV.Func
```

With respect to regional trait sets, tests performed using AVGi (\autoref{fig:MI_Dev}) indicate a pattern consistent with the findings regarding localized sets (\autoref{fig:MI_Func}). Considering only interlandmark distances, Facial traits are detected as a valid modular partition both with size variation retained or removed, while Neurocranial traits are detected as a valid partition only when size variation is removed. This pattern mirrors the contrast between Oral and Vault traits in the localized sets regarding interlandmark distances. Considering Procrustes residuals, Neurocranial traits are a valid partition with both size retained and removed; once again, this pattern mirrors the detection of the Basicranial partition as valid in the localized sets. Finally, in local shape variables, both Face and Neurocranium are detected as valid with size retained; with size removed, only the Face is recognized. The same can be observed in the localized sets, where removing allometric variation affects the detection of the Vault set. The tests for distinction between within-set and between-set correlations for these two sets (designated 'Neuroface') show a pattern that is consistent with tests for the individual sets, that is, if one of the sets was previously detected, this distinction is also detected as valid with high probability.

```{r MI_Dev, echo = FALSE, fig.cap = captions $ fig.MI_Dev, fig.width = 9.6, fig.height = 10.8}
modcomp.Plots $ MI.Dev 
```

Tests performed for this distinction between Face and Neurocranium using RV coefficients (\autoref{fig:RV_Dev}) show that in most cases, for both interlandmark distances and local shape variables, both regions are considered distinct and valid variational modules; in Procrustes residuals, only in a handful of taxa the same result can be observed. In this case, the correspondence with results for localized trait sets (\autoref{fig:RV_Func}) is more difficult, due to the lack of independent tests for each region.

```{r RV_Dev, echo = FALSE, fig.cap = captions $ fig.RV_Dev, fig.width = 5.2, fig.height = 6.4}
modcomp.Plots $ RV.NeuroFace +
  facet_wrap(~size, ncol = 2) +
  theme (text = element_text (size = 8)) 
```

## Error Rates

Comparing the distributions of AVGi and RV values from theoretical matrices with respect to their structure (\autoref{fig:stat_dist_sim}) shows marked differences between metrics and morphometric variables from which correlations are sampled. For local shape variables, the distribution of both AVGi and RV values for $\mathbf{C}_s$ and $\mathbf{C}_r$ matrices overlap very little; for interlandmark distances, the distribution of AVGi values for both matrix types also has little overlap, while the same distributions for RV have a substantial overlap. Finally, for Procrustes residuals, while the distribution of AVGi values for both matrix types are overlapping to some degree, the same distributions for RV values are identical. It is noteworthy that removing size or allometry does not change these distributions in most cases; only for RV values estimated over matrices derived from correlation distributions for interlandmark distances, in which the removal of size variation increases the overlap in $\mathbf{C}_s$ and $\mathbf{C}_r$ distributions.

```{r stat_dist_sim, echo = FALSE, fig.cap = captions $ fig.stat_dist_sim, fig.width = 9.6, fig.height = 6.4, message = FALSE}
alt.dist.sim
```

With respect to the relationship between significance levels and Type I error rates, estimated over $\mathbf{C}_r$ matrices, \autoref{fig:type1} shows that these quantities approach an identity relationship very closely, regardless of whether we use AVGi or RV to quantify variational modularity; even at low sample sizes, Type I error rates are very close to significance levels.

```{r type1, echo = FALSE, fig.cap = captions $ fig.type1, fig.width = 9.6, fig.height = 10.8, message = FALSE}
modsim.Plots $ Type1 
```

When we consider the relationship between power and significance levels, estimated over $\mathbf{C}_s$ matrices, there are substantial differences with respect both to the chosen statistic (AVGi or RV) and to the type of variable from which correlations are sampled. Considering local shape variables (\autoref{fig:type2}), tests using both AVGi and RV have high power, regardless of sample size or effect size; however, it is noteworthy that, for lower effect sizes (represented by high average squared correlation between sets, $b^2$) power for tests performed using AVGi is higher than for those using RV. As effect size increases (lower $b^2$ values), the difference in power between the two metrics decreases.


```{r type2_def, echo = FALSE, fig.cap = captions $ fig.type2_def, fig.width = 9.6, fig.height = 10.8, message = FALSE}
modsim.Plots $ Type2.Def
```

```{r type2_ed, echo = FALSE, fig.cap = captions $ fig.type2_ed, fig.width = 9.6, fig.height = 10.8, message = FALSE}
modsim.Plots $ Type2.ED
```

```{r type2_sym, echo = FALSE, fig.cap = captions $ fig.type2_sym, fig.width = 9.6, fig.height = 10.8, message = FALSE}
modsim.Plots $ Type2.Sym
```

# Discussão

Considerando os resultados obtidos a partir das matrizes teóricas, observamos que a distribuição de correlações derivadas de cada tipo de variável (\autoref{fig:cor_dist}) são particularmente importantes para o seu entendimento, visto que estas matrizes teóricas são derivadas destas distribuições. No caso dos resíduos de Procrustes, o procedimento de superposição e a premissa de variação isotrópica em torno de cada marco anatômico acaba por gerar uma distribuição de correlações médias dentro e entre regiões que é marcada por uma diferença pequena entre estes dois tipos de correlações, independentemente se consideramos a distribuição com tamanho mantido ou removido. Visto que esta diferença é pequena, o poder de ambos os teste se reduz bastante em testes realizados nas matrizes $\mathbf{C}_s$ derivadas desta distribuição.

Ademais, estas correlações médias derivadas de resíduos de Procrustes são bastante próximas de zero, de modo que o poder do índice RV é bastante prejudicado neste caso, visto que o cômputo do RV envolve variâncias e covariâncias ao quadrado. Como o índice AVG lida com correlações em sua escala natural, sua performance em matrizes $\mathbf{C}_s$ não é drasticamente prejudicada.

# References
